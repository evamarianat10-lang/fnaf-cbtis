<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SISTEMA DE SEGURIDAD - CBTis 187</title>
    <style>
        body { 
            background-color: #050505; 
            color: #00FF00; 
            font-family: 'Courier New', monospace; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            height: 100vh; 
            margin: 0; 
            overflow: hidden; 
        }

        #game-container { 
            border: 2px solid #222; 
            padding: 20px; 
            width: 95%; 
            max-width: 850px; 
            background: rgba(0, 0, 0, 0.9); 
            box-shadow: 0 0 30px rgba(255, 0, 0, 0.3); 
            text-align: center;
        }

        .header { 
            display: flex; 
            justify-content: space-between; 
            border-bottom: 2px solid #333; 
            margin-bottom: 15px; 
            padding-bottom: 10px; 
            font-weight: bold;
        }

        .question { 
            color: #ffffff; 
            font-size: 1.2em; 
            min-height: 60px;
            margin: 20px 0;
            text-shadow: 0 0 5px #ff0000;
        }

        .options { 
            display: grid; 
            grid-template-columns: 1fr 1fr; 
            gap: 10px; 
        }

        .options button { 
            padding: 12px; 
            background: #000; 
            color: #0f0; 
            border: 1px solid #0f0; 
            cursor: pointer; 
            font-family: inherit; 
            transition: 0.2s;
        }

        .options button:hover { 
            background: #ff0000; 
            color: white; 
            border-color: white; 
        }

        /* CAPA DEL JUMPSCARE */
        #jumpscare-overlay { 
            display: none; 
            position: fixed; 
            top: 0; 
            left: 0; 
            width: 100vw; 
            height: 100vh; 
            background: black; 
            z-index: 10000; 
        }

        #foxy-video { width: 100%; height: 100%; object-fit: cover; }

        .start-btn { 
            padding: 20px 40px; 
            font-size: 1.5em; 
            background: #b71c1c; 
            color: white; 
            border: none; 
            cursor: pointer; 
            font-family: inherit;
        }
    </style>
</head>
<body>

<div id="jumpscare-overlay">
    <video id="foxy-video">
        <source src="foxy_jumpscare.mp4" type="video/mp4">
    </video>
</div>

<div id="game-container">
    <div id="menu">
        <h1 style="color: #ff0000;">MODO SUPERVIVENCIA: 2:51</h1>
        <p>CBTis 187 - Programación</p>
        <p>Responde 50 preguntas únicas antes de que el tiempo se agote.</p>
        <button class="start-btn" onclick="iniciarJuego()">CONECTAR TERMINAL</button>
    </div>

    <div id="juego" style="display:none;">
        <div class="header">
            <span>PREGUNTA: <span id="current-q">0</span>/50</span>
            <span>ACIERTOS: <span id="puntos-val">0</span></span>
            <span>TIEMPO: <span id="timer-val">2:51</span></span>
        </div>
        <p id="pregunta" class="question"></p>
        <div id="opciones" class="options"></div>
    </div>
</div>

<script>
    // PEGA AQUÍ TU LINK DE GOOGLE APPS SCRIPT
    const WEB_APP_URL = "TU_LINK_AQUI"; 

    let nPregunta = 0;
    let aciertos = 0;
    let tiempoRestante = 171; 
    let juegoActivo = false;
    let bancoPreguntas = [];

    const masterPool = [
        {p: "¿Quién es el asesino de los 5 niños?", o: ["William Afton", "Henry Emily", "Mike"], r: "William Afton"},
        {p: "¿Cómo se llama el oso principal?", o: ["Freddy", "Bonnie", "Foxy"], r: "Freddy"},
        {p: "¿Qué animatrónico corre por el pasillo en FNAF 1?", o: ["Foxy", "Chica", "Bonnie"], r: "Foxy"},
        {p: "¿Quién posee a Puppet?", o: ["Charlotte Emily", "Elizabeth", "Susie"], r: "Charlotte Emily"},
        {p: "¿En qué año ocurrió la mordida de Fredbear?", o: ["1983", "1987", "1993"], r: "1983"},
        {p: "¿Cómo se llama el conejo de FNAF 1?", o: ["Bonnie", "Springtrap", "Toy Bonnie"], r: "Bonnie"},
        {p: "¿Qué animatrónico no tiene cejas en FNAF 1?", o: ["Bonnie", "Freddy", "Foxy"], r: "Bonnie"},
        {p: "¿Cómo se llama el local de FNAF 2?", o: ["Freddy Fazbear's Pizza", "Fredbear's", "Circus Baby"], r: "Freddy Fazbear's Pizza"},
        {p: "¿Quién es el protagonista de FNAF 3?", o: ["Michael Afton", "William", "Henry"], r: "Michael Afton"},
        {p: "¿Qué animatrónico es un payaso en Sister Location?", o: ["Baby", "Ballora", "Ennard"], r: "Baby"},
        {p: "¿Cómo se llama el guardia de FNAF 1?", o: ["Mike Schmidt", "Jeremy", "Fritz"], r: "Mike Schmidt"},
        {p: "¿Qué color representa a William Afton?", o: ["Morado", "Rosa", "Naranja"], r: "Morado"},
        {p: "¿Quién causó la mordida del 87?", o: ["Mangle", "Foxy", "Freddy"], r: "Mangle"},
        {p: "¿Cómo se llaman los modelos viejos de FNAF 2?", o: ["Withered", "Nightmare", "Phantom"], r: "Withered"},
        {p: "¿Qué mascota tiene Chica?", o: ["Cupcake", "Pizza", "Guitarra"], r: "Cupcake"},
        {p: "¿En qué juego aparece Springtrap?", o: ["FNAF 3", "FNAF 2", "FNAF 4"], r: "FNAF 3"},
        {p: "¿Cómo se llama el oso de FNAF 4?", o: ["Nightmare Freddy", "Toy Freddy", "Rockstar"], r: "Nightmare Freddy"},
        {p: "¿Qué alma habita en Chica?", o: ["Susie", "Fritz", "Gabriel"], r: "Susie"},
        {p: "¿Qué animal es Mangle?", o: ["Zorro", "Lobo", "Perro"], r: "Zorro"},
        {p: "¿Cómo se llama el oso dorado?", o: ["Golden Freddy", "Yellow Bear", "Fredbear"], r: "Golden Freddy"},
        {p: "¿Cómo se llama el cocodrilo?", o: ["Montgomery", "Freddy", "Roxy"], r: "Montgomery"},
        {p: "¿Quién te ayuda en Security Breach?", o: ["Freddy", "Chica", "Monty"], r: "Freddy"},
        {p: "¿Cómo se llama el conejo glitch?", o: ["Glitchtrap", "Burntrap", "Scraptrap"], r: "Glitchtrap"},
        {p: "¿Qué animatrónico tiene un gancho?", o: ["Foxy", "Freddy", "Bonnie"], r: "Foxy"},
        {p: "¿Cómo se llama la loba?", o: ["Roxy", "Chica", "Vanny"], r: "Roxy"},
        {p: "¿Quién es la villana en Security Breach?", o: ["Vanny", "Elizabeth", "Cassidy"], r: "Vanny"},
        {p: "¿Qué animatrónico es una bailarina?", o: ["Ballora", "Baby", "Minireena"], r: "Ballora"},
        {p: "¿Cómo se llama el oso de ayuda en FNAF 6?", o: ["Helpy", "Lefty", "Molten Freddy"], r: "Helpy"},
        {p: "¿De qué color es Bonnie en FNAF 1?", o: ["Morado/Azul", "Celeste", "Verde"], r: "Morado/Azul"},
        {p: "¿Quién creó FNAF?", o: ["Scott Cawthon", "Markiplier", "MatPat"], r: "Scott Cawthon"},
        {p: "¿Qué animatrónico atrapa a Puppet?", o: ["Lefty", "Freddy", "Ennard"], r: "Lefty"},
        {p: "¿Cuál fue el primer restaurante?", o: ["Fredbear's Family Diner", "Freddy's", "El Chip"], r: "Fredbear's Family Diner"},
        {p: "¿Qué alma habita en Foxy?", o: ["Fritz", "Jeremy", "Gabriel"], r: "Fritz"},
        {p: "¿Cómo se llama la hermana de Mike?", o: ["Elizabeth", "Charlotte", "Susie"], r: "Elizabeth"},
        {p: "¿En qué juego no hay cámaras?", o: ["FNAF 4", "FNAF 1", "FNAF 2"], r: "FNAF 4"},
        {p: "¿Qué usas para engañar a los Toy?", o: ["Máscara de Freddy", "Linterna", "Puertas"], r: "Máscara de Freddy"},
        {p: "¿Cómo se llama el sol?", o: ["Daycare Attendant", "Sun", "Sunrise"], r: "Daycare Attendant"},
        {p: "¿Quién canta en la oscuridad?", o: ["Freddy", "Foxy", "Chica"], r: "Freddy"},
        {p: "¿Modo más difícil de la UCN?", o: ["50/20", "Hard Mode", "Nightmare"], r: "50/20"},
        {p: "¿Quién es la amalgama de cables?", o: ["Ennard", "Molten Freddy", "Baby"], r: "Ennard"},
        {p: "¿Qué objeto está siempre en la mesa?", o: ["Ventilador", "Copa", "Papel"], r: "Ventilador"},
        {p: "¿Qué frase aparece en las paredes?", o: ["IT'S ME", "Hello?", "Help"], r: "IT'S ME"},
        {p: "¿Qué tipo de animal es Chica?", o: ["Pollo", "Pato", "Canario"], r: "Pollo"},
        {p: "¿Quién te llama por teléfono?", o: ["Phone Guy", "Phone Man", "Scott"], r: "Phone Guy"},
        {p: "¿Quién tiene la caja de música?", o: ["Puppet", "Balloon Boy", "Toy Freddy"], r: "Puppet"},
        {p: "¿Guardia principal de FNAF 2?", o: ["Jeremy Fitzgerald", "Mike", "William"], r: "Jeremy Fitzgerald"},
        {p: "¿Quién pide 5 monedas?", o: ["Rockstar Freddy", "Candy Cadet", "Music Man"], r: "Rockstar Freddy"},
        {p: "¿Cómo se llaman los del SB?", o: ["Glamrocks", "Toys", "Rockstars"], r: "Glamrocks"},
        {p: "¿Qué animal es Monty?", o: ["Caimán", "Lagarto", "Dinosaurio"], r: "Caimán"},
        {p: "¿Cómo se llama el conejo de mano?", o: ["Bon-Bon", "Bonnie", "Toy Bonnie"], r: "Bon-Bon"}
    ];

    function iniciarJuego() {
        bancoPreguntas = [...masterPool].sort(() => Math.random() - 0.5);
        document.getElementById('menu').style.display = 'none';
        document.getElementById('juego').style.display = 'block';
        juegoActivo = true;
        siguientePregunta();
        
        const contador = setInterval(() => {
            if (!juegoActivo) { clearInterval(contador); return; }
            tiempoRestante--;
            actualizarReloj();
            if (tiempoRestante <= 0) { 
                clearInterval(contador);
                ejecutarJumpscare(); 
            }
        }, 1000);
    }

    function actualizarReloj() {
        let min = Math.floor(tiempoRestante / 60);
        let seg = tiempoRestante % 60;
        document.getElementById('timer-val').innerText = `${min}:${seg < 10 ? '0' + seg : seg}`;
    }

    function enviarDatos(pregunta, respuesta, esCorrecta) {
        if(WEB_APP_URL === "TU_LINK_AQUI") return;
        fetch(WEB_APP_URL, {
            method: "POST",
            mode: "no-cors",
            body: JSON.stringify({ pregunta, respuesta, esCorrecta, total: aciertos })
        });
    }

    function siguientePregunta() {
        if (nPregunta >= 50) { victoria(); return; }

        let actual = bancoPreguntas.pop();
        nPregunta++;
        document.getElementById('current-q').innerText = nPregunta;
        document.getElementById('pregunta').innerText = actual.p;
        
        const contenedor = document.getElementById('opciones');
        contenedor.innerHTML = '';
        
        let opciones = [...actual.o].sort(() => Math.random() - 0.5);

        opciones.forEach((texto) => {
            const btn = document.createElement('button');
            btn.innerText = texto;
            btn.onclick = () => {
                let correcta = (texto === actual.r);
                if(correcta) {
                    aciertos++;
                    document.getElementById('puntos-val').innerText = aciertos;
                }
                enviarDatos(actual.p, texto, correcta);
                siguientePregunta();
            };
            contenedor.appendChild(btn);
        });
    }

    function victoria() {
        juegoActivo = false;
        alert("¡SISTEMA ASEGURADO!\nAciertos: " + aciertos + "/50.");
        location.reload();
    }

    function ejecutarJumpscare() {
        juegoActivo = false;
        const overlay = document.getElementById('jumpscare-overlay');
        const video = document.getElementById('foxy-video');
        overlay.style.display = 'block';
        
        video.play().then(() => {
            video.onended = () => {
                alert("FIN DE LA CONEXIÓN\nAciertos logrados: " + aciertos + " / 50");
                location.reload();
            };
        }).catch(() => {
            alert("¡FOXY TE ATRAPÓ!\nAciertos logrados: " + aciertos + " / 50");
            location.reload();
        });
    }
</script>
</body>
</html>

